<!doctype html>
<head>
	<title>Mapbox Studio Cartography</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width" />
	<link rel="stylesheet" type="text/css" href="sizes.css" media="all" />
	<link rel="stylesheet" type="text/css" href="style.css" media="all" />
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Kaushan+Script' rel='stylesheet' type='text/css'>
</head>

<body>
	<nav class="navbar navbar-brand">
		<a href="http://www.mapsmith.net" target="_blank" class="navbar-brand">
			Mapsmith
		</a>
	</nav>
<div class="container">
	<header role="banner">
		<h1><span id="mapbox">Mapbox Studio</span> Cartography</h1>
		<div>by <a href="http://mapsmith.net">Stephen Smith</a></div>
	</header>
	<hr />
	<main role="main">

		<p class="intro">
			I've been playing around with the new
			<a href="http://www.mapbox.com/studio" id="mapbox" target="_blank">Mapbox Studio</a>
			for a couple of weeks - putting the tool through it's paces in an attempt to
			push the cartographic envelope.
		</p>
		<p>
			Below is a <em>very</em> long, in-depth walkthrough of the latest mapping tool
			developed by
			the <a href="http://www.osm.org" target="_blank">OpenStreetMap</a> powerhouse.
		</p>
		<h3>The Goal:</h3>
		<h4>
				Develop a map inspired by neon signs.
		</h4>
		<img src="img/mellow-mushroom.jpg" alt="" class="shadow"/>
		<p>
			But first...
		</p>

		<h3>What is <span id="mapbox">Mapbox Studio?</span></h3>

		<div class="">
			<blockquote>
				<p><em>
					<span id="mapbox">Mapbox Studio</span> is a web-based mapping application
					that allows you to quickly style a map of the
					<strong>entire</strong> world.
				</em></p>
			</blockquote>
		</div>



		<h3>Let's unpack that</h3>
		<p>
			That statement is actually pretty f$#%ing amazing, and I don't want you to
			take it for granted. Simply put, this tool is unique in that it was
			<strong>literally impossible</strong> to achieve <em>not that long ago</em>.
		</p>
		<p>
			When desktop GIS first became <em>a thing</em>, it would have been nearly impossible to have
			enough computing power and storage space to make such a detailed map of the world.
			Let alone the fact that a worldwide, digital, street-level dataset probably only existed
			in the halls of the world intelligence agencies.
		</p>
		<p>
			Think about how crazy it was in 1996 when Mapquest launched. It was a
			<em>revelation</em> that you could use the internet to find directions between
			(most) any two places on the planet. But this was still the sole domain of the
			super-powerful internet companies.
		</p>
		<p>
			When Steve Coast founded OpenStreetMap in 2005, we're starting to get the groundwork
			laid for everyone to be able to map the world, but not many people had the computing
			power, bandwith, and expertise to <em>consume</em> such a massive data source.
		</p>
		<p>
			Now, in 2015, <span id="mapbox">Mapbox</span> has finally removed the last remaining
			technical hurdle. The <strong>entire workflow</strong> for making your own, customized
			map of the entire world is:
			<ol>
				<li>Create an account</li>
				<li>Log in</li>
				<li>Launch <span id="mapbox">Mapbox Studio</span> </li>
				<li>Map.</li>
			</ol>
		</p>
		<p>
			With this perspective in mind, let's make a map.
		</p>
			<!-- TODO: Find a way to <hide> this segment -->
			<!-- To understand <strong>how</strong> amazing the above
			statement is, we'll have to go waaaay back.
			<em>Let's start at the beginning.</em>
		</p>

		<h4>
			In the beginning...
		</h4>
		<p>
			In humankind's cave-dwelling days, when maps weren't even <em>a thing</em>,
			 <strong>this was impossible.</strong>
		</p>

		<h4>When we formed tribes...</h4>
		<p>
			We needed maps to know where to hunt and where the next village was, but
			a <em>world</em> maps was <strong>impossible.</strong>
		</p>

		<h4>When we started farming...</h4>
		<p>
			We needed maps for our farms and our towns, but a world map was still
			<strong>impossible.</strong>
		</p>

		<h4>When the first cities formed...</h4>
		<p>
			We could make maps of our region, but going much further than that was
			still <strong>impossible.</strong>
		</p>

		<h4>When we conquered the seas...</h4>
		<p>
			Here's where we start getting closer. When explorers needed to get from Lisbon
			to Naples, they needed <em>charts</em> of a much larger area. Now we're getting
			<em>closer,</em> but think about what's needed to make a map of the
			Mediterranean. You need a fleet of ships, tons of crew, months of supplies,
			and lots of math. Basically, this was <strong>still impossible.</strong>
		</p>

		<h4>When Columbus sailed the ocean blue...</h4>
		<p>
			Getting closer still. As a civilization we're starting to get a
			<em>rough</em> idea of what's out there, but we still wouldn't get a
			<em>complete</em> picture for quite some time. Let's dub the possibility in
			1492 as <strong>extremely difficult</strong>, but not impossible any more.
		</p>

		<h4>When the sun never set on the British empire...</h4>
		<p>
			If you rule most of the world, you probably want to know <em>what exactly</em>
			you're ruling, so you put quite a bit of effort into mapping it. So, with
			the might of the entire British empire, you can now reasonably create a
			map of the entire world.
		</p>

		<h4>When planes were used for reconaissance...</h4>
		<p>
			Now we're getting an even better picture of our world, but you still need
			to be a government cartographer with specialized equipment to come close.
		</p>

		<h4>When we launched the first satellites...</h4>
		<p>
			Even closer, but the quantity and quality of the data, along with the
			specialized mapmaking tools, are reserved for the very few.
		</p>

		<h4>When OpenStreetMap was founded...</h4>
		<p>
			Now we get to the first place where <em>everyday</em> cartographers can
			get access to a dataset covering the <strong>entire world</strong> (eventually),
			but you have to have a very powerful machine and have a high technical
			proficciency to download, unpack, process, and store <code>planet.osm</code>.
		</p>

		<h4>When <span id="mapbox">Mapbox</span> creates OSM vector tiles...</h4>
		<p>
			Finally, we've arrived at <strong>possible.</strong>
		</p> -->

		<!-- <ul>
			<li>Web-based application</li>
		</ul>
		<p>
			The first few cartography tools that <span id="mapbox">Mapbox</span> created
			were cross-platform, open-source <em>desktop</em> applications.
		</p>

		and their amazing
		<a href="http://www.osm.org" target="_blank">OpenStreetMap</a>
		data and

		using <span id="mapbox">Mapbox's</span>
		<code>JSON</code>-based graphics styling language -->

		<h2>Making a map</h2>
		<p>
			<small>
			<em>(Note: These screenshots were taken during the beta and may vary slightly from the current version.)</em>
			</small> <br>
			It's pretty simple to get started. Just create a new style, and then pick
			from one of <span id="mapbox">Mapbox</span>'s existing styles or start from
			a blank source.
		</p>
		<img src="img/new_style.jpeg" alt="" class="shadow"/>

		<h3>The blank source</h3>
		<p>
			It can be rather daunting to start from the ground up, but if you're wanting
			to really make something unique I think it's a must.
		</p>
		<img src="img/blank.jpeg" alt="" class="shadow"/>
		<p>
			This doesn't look to dissimilar to a traditional GIS program. You launch it,
			and it sits there - empty - waiting for your data.
		</p>

		<h3>Selecting data</h3>
		<p>
			Thankfully <small><em>(and miraculously, as mentioned previously)</em></small>,
			<span id="mapbox">Mapbox</span> has provided the data for the
			<strong>entire world</strong> for you to style (courtesy of OpenStreetMap).
		</p>
		<p>
			Start by opening the "New Layer" pane. This changes the map view from "Cartography"
			to "X-Ray" mode, allowing you to see all the data behind the scenes.
		</p>
		<img src="img/add_data.jpeg" alt="" class="shadow"/>
		<p>
			You get a preview of the depth and breadth of information available at your fingertips.
			You just need to click on the data in the map that you want to style and hit "Select."
		</p>
		<div class="centered">
			<img src="img/select.jpeg" alt="" class="shadow"/>
		</div>
		<p>
			Once a layer has been selected, the data is highlighted in the map. This will
			be especially helpful later when filters are required.
		</p>
		<img src="img/selected.jpeg" alt="" class="shadow"/>
		<p>
			Go ahead and press "Create Layer" and the map switches back to Style mode.
		</p>

		<h3>Styling data</h3>
		<p>
			Now we get our first look at the map styling tools. Also, we can breathe
			a slight sigh of relief that our map is no longer blank.
		</p>
		<img src="img/style1.jpeg" alt="" class="shadow"/>
		<p>
			Let's see what we have to work with.
		</p>
		<img src="img/polygon_tools.jpeg" alt="" class="shadow"/>
		<p>
			Let's break down our toolbox.
			<ul>
				<li>Color picker</li>
				<ul>
					<li><img src="img/colorpicker.jpeg" alt="" class="shadow"/></li>
				</ul>
				<li>Pattern Picker</li>
				<ul>
					<li><img src="img/patternpicker.jpeg" alt="" class="shadow"/></li>
				</ul>
				<li>Opacity Slider</li>
				<ul>
					<li><img src="img/opacityslider.jpeg" alt="" class="shadow"/></li>
				</ul>
				<li>Antialias Toggle <small>(a 1px outline)</small> </li>
				<ul>
					<li><img src="img/antialias.jpeg" alt="" class="shadow"/></li>
					<li><em>Notice the handy popup? Every descriptive text does that just in case you're wondering what a property does.</em></li>
				</ul>
				<li>Antialias Color Picker</li>
				<ul>
					<li><img src="img/antialias_color.jpeg" alt="" class="shadow"/></li>
				</ul>
				<li>Translation Settings</li>
				<ul>
					<li><img src="img/translate.jpeg" alt="" class="shadow"/></li>
				</ul>
			</ul>
		</p>

		<p>
			That's a pretty standard set of tools, not a lot of mind-blowing stuff in the
			polygon styling toolbelt...
		</p>
		<p>
			Oh, except did I mention...? Everything you do <strong>changes live?</strong>
		</p>
		<p>
			Let's take another look at that color picker in action.
		</p>
		<div class="centered">
			<img src="img/colorpicker.jpg" alt="" class="shadow"/><br>
			<small><em><a href="img/colorpicker-sm.gif" target="_blank">Click for GIF</a></em></small>
		</div>
		<p>
			This is due to the amazing technology <span id="mapbox">Mapbox</span> uses
			to render the map in your browser. Basically, it uses your graphics card to
			render the map <em>constantly</em> at 60 frames per second. This allows for
			the cartographer to get instant feedback on their design, and for the user
			to never have to wait for the next zoom level to load. This is a gross
			oversimplification, so if you want to learn more about the underlying
			technology head over to the
			<a href="https://www.mapbox.com/blog/mapbox-gl/" target="_blank"><span id="mapbox">Mapbox</span> blog.</a>
		</p>

		<h3>Building the Style</h3>
		<h4>Land</h4>
		<p>
			Let's keep building the map. We've got the water, let's add the land.
		</p>
		<p>
			One important thing to note when creating your map is that your underlying
			background data (water and land), only the <strong>water</strong>
			is actual data. To save space, you style the land by styling the
			<em>background</em> of the map (i.e. the absence of water).
		</p>
		<img src="img/background.jpeg" alt="" class="shadow" />

		<h4>Countries</h4>
		<p>
			Let's add the country boundaries. This will give us a chance to highlight
			the built-in query tools.
		</p>
		<img src="img/admin.jpeg" alt="" class="shadow" />
		<p>
			When you select the <code>admin</code> layer, you get the entire unfiltered
			dataset. I want to style only the land country boundaries, so I click the
			<code>add filter</code> button to see what attributes can be queried out.
		</p>
		<img src="img/admin-filter.gif" alt="" class="shadow"/>
		<p>
			For this layer I only want to see level 2 (country), undisputed land boundaries.
			Let's look at the ways we can style lines.
		</p>
		<img src="img/line.jpeg" alt="" class="shadow"/>
		<p>
			This is a pretty standard set of line styling options. There are a couple
			of options worth noting though. The <code>gap width</code> option is
			nice for allowing you to have "casing" for your roads or
			paths for example.
		</p>
		<img src="img/line-case-bright.jpeg" alt="" class="shadow" />
		<p>
			<em>This is great for road casing. It gives a slight visual separation
			to the roads. <small> (via Mapbox Streets style)</small></em>
		</p>
		<p>
			The <code>blur</code> setting is an interesting one that we'll check out next
		</p>
		<strong>Styling</strong>
		<p>
			So let's give our country lines the following settings: <br>
			<div class="table shadow">
				<code>
					color: #EF0 <br>
					dasharray: [1,2]
				</code>
			</div>
		</p>
		<img src="img/admin2-1.jpeg" alt="" class="shadow"/>
		<p>
			That's nice, but it stays at <code> width: 1px</code> no matter how much
			you zoom in. Let's make the line width <strong>vary with zoom level.</strong>
		</p>
		<strong>Enter Ramps</strong>
		<p>
			Gone are the days of <code>CartoCSS</code> where you'd have to set explicit
			style breaks at integer zoom levels. <small><em>("back in my day...")</em></small>.
			Now a <strong>function</strong> defines the way your style changes as you zoom.
			This allows you to very quickly setup complex rules for your styles.
		</p>
		<img src="img/admin2-ramp.jpeg" alt="" class="shadow"/>
		<p>
			So our yellow dashed country boundaries are nice looking, but let's
			<strong>kick'em up a notch!</strong>.
		</p>
		<strong>Layering layers</strong>
		<p>
			My biggest complaint with migrating away from <code>CartoCSS</code> to
			<a href="https://www.mapbox.com/mapbox-gl-style-spec/" target="_blank"><code>Mapbox GL</code></a>
			is the fact that the same data layer can't hold multiple styles.
			Functionally what this means is that if you want any sort of complicated
			symbology you need to duplicate that layer in your table of contents.
		</p>
		<p>
			For this map, that means we're ultimately going to end up with
			<strong>over 100 layers.</strong> <em>(You've been warned)</em>
		</p>
		<p>
			So, let's get started.
		</p>
		<p>
			Start by duplicating the existing <code>admin</code> layer with the
			button at the top of the table of contents.
		</p>
			<img src="img/duplicate.jpeg" alt="" class="small shadow"/>
			<p>
			We're going to create a neon light-like glowing effect, so below the
			bright yellow <code>#EF0</code> color we'll put a darker color. We'll
			also make it wider and utilize the <code>blur</code> function.
			</p>
			<div class="table shadow">
				<table align="center">
					<tr>
						<td><code>color:</code></td>
						<td><code>#AB0</code></td>
					</tr>
					<tr>
						<td><code>width:</code></td>
						<td><code>
							[0,0.5 <br>
							22, 30]</code></td>
					</tr>
					<tr>
						<td><code>blur:</code></td>
						<td><code>
							[0,0 <br>
							22,17]</code></td>
					</tr>
				</table>
			</div>
			<p>
				That will create a pretty nice effect, but we're not done yet. Let's do it one more
				time with an even darker yellow and an even wider stroke and larger blur.
			</p>
			<div class="table shadow">


				<table align="center">
					<tr>
						<td><code>color:</code></td>
						<td><code>#660</code></td>
					</tr>
					<tr>
						<td><code>width:</code></td>
						<td><code>
							[0,5 <br>
							10, 30]</code></td>
					</tr>
					<tr>
						<td><code>blur:</code></td>
						<td><code>
							[0,10 <br>
							10,20]</code></td>
					</tr>
				</table>
			</div>
			<p>
				Notice that the ramps aren't a slow steady march from <code>z0</code>
				to <code>z22</code>. In this case I ramp them up quickly so that by time
				the user gets to <code>z10</code> the admin lines are at their widest.
				This also means that as they get closer and closer the "visual importance"
				of the country boundaries fade. This is sensible for the country borders
				because as the map gets more and more detailed, the border becomes
				less important visually and the roads start demanding the higher
				visual importance.
			</p>
			<p>
				The result will be something like this:
			</p>
			<img src="img/admin-ex@3x.jpeg" alt="" class="shadow"/>
			<p>
				Now you're probably starting to piece together why there will  be over
				100 levels. If we want a glowing effect on all the lines then we're going
				to have to <em>duplicate each line</em> several times.
			</p>
			<p>
				So here's our world map with yellow dashed neon country borders.
			</p>
			<img src="img/admin2-done.jpeg" alt="" class="shadow"/>
			<p>
				And here it is a little closer:
			</p>
			<img src="img/admin2-closeup.jpeg" alt="" class="shadow"/>
			<p>
				Next I'm going to add admin level 4 (states) in a similar style, but purple
				and a little thinner than the country borders.
			</p>
			<img src="img/admin4.jpeg" alt="" class="shadow"/>
			<strong>Water</strong>
			<p>
				Those Swiss lakes look a little dull, let's make them glow!
			</p>
			<p>
				Now we'll do something just a little tricky. We're going to take the
				<code>water</code> layer - which is a polygon dataset - and add
				it to our table of contents as a <strong>line</strong> layer.
			</p>
			<p>
				In the <code>New Layer</code> view, select the <code>water</code>
				dataset, and then at the bottom change the type from
				<strong>fill</strong> to <strong><em>line</em></strong>.
			</p>
			<img src="img/water-line.jpeg" alt="" class="shadow"/>
			<p>
				This new layer will automatically appear at the top of your table of
				contents, but we don't necessarily want it there. To rearrange, simply
				click and drag on the layer!
			</p>
			<div class="centered">
				<img src="img/rearrange.gif" alt="" class="shadow"/>
			</div>
			<p>
				Nice.
			</p>
			<img src="img/water-glow.jpeg" alt="" class="shadow"/>

			<strong>Basic Labels</strong>
			<p>
				Let's give our map readers some context as their zooming in on our map
				by adding country labels.
			</p>
			<p>
				Start by creating a new layer using the <code>country_label</code>
				layer.
			</p>
			<img src="img/admin-pts-new.jpeg" alt="" class="shadow"/>
			<p>
				Be sure to add a filter for <code>type = country</code> and change the
				type of layer at the bottom to <code>Symbol</code>
			</p>
			<p>
				<span id="mapbox">Mapbox</span> has generously teamed up with
				<a href="https://www.fontfont.com/" target="_blank">FontFont</a> to provide
				a very nice assortment of professional fonts for your map design pleasure.
				Let's pick one that's angular and technical looking so that it matches
				our neon theme. I opted to go with
				<span id="magda">Magda Clean Mono Offc Pro Black.</span>
			</p>
			<p>
				Let's style those labels.
			</p>
			<img src="img/country-labels.jpeg" alt="" class="shadow"/>
			<p>
				Another thing we want to do is have state labels show up at some point
				as you zoom in. For this we'll use the <code>zoom-extent</code> setting
				in the new layer window.
			</p>
			<img src="img/zoom-extent.jpeg" alt="" class="shadow"/>

			<strong>Highways</strong>

			<p>
				Alright, this post is getting <em>really</em> long, so we'll skip ahead
				to the really neat part - <strong>neon roads.</strong>
			</p>
			<p>
				Start by creating a new layer using the <code>road</code> dataset with
				a filter of <code>class = 'motorway'</code>.
			</p>
			<img src="img/motorway-data.jpeg" alt="" class="shadow"/>
			<p>
				To create a glowing neon effect, we're actually going to stack
				<em>three different layers</em> of the same data using different styles.
				Remember how we stacked up several layers to making the glowing country
				borders earlier? We'll do the same thing here for the highways.
			</p>
			<p>
				The result with look something like this.
			</p>
			<img src="img/hwy-glow-ex@3x.jpeg" alt="" class="shadow" />
			<p>
				Let's get started. First let's make the thin top layer. It is a thin,
				yellowish, slightly blurry line.
			</p>
			<img src="img/highway-lite.jpeg" alt="" class="shadow" />
			<p>
				Next, duplicate the layer, make it a little orange-er, a little wider,
				and a little blurrier.
			</p>
			<img src="img/highway-med.jpeg" alt="" class="shadow"/>
			<p>
				Next, duplicate the layer again, make it a little orange-er, a little wider,
				and a little blurrier.
			</p>
			<img src="img/highway-drk.jpeg" alt="" class="shadow"/>
			<p>
				Let's see how that looks as we zoom in.
			</p>
			<div class="centered">
				<img src="img/highway-zoom.jpg" alt="" class="shadow"/> <br>
				<small><em><a href="img/highway-zoom.gif" target="_blank">Click for GIF</a></em></small>
			</div>
			<p>
				I've added lower level streets just for reference. Also, there are gaps
				between different segments because the <code>road</code> dataset doesn't
				include bridges. To get those to show up you need to duplicate the layers
				and change the data source to the <code>bridge</code> dataset.
			</p>
			<h2>Explore the Final Product</h2>
			<p>
				Here is the completed map.
			</p>
			<div class="map">
				<iframe src="http://bl.ocks.org/TheMapSmith/raw/2966bfa0af4d76c2af3a/" width="100%" height="400"></iframe>
				<small><a href="http://bl.ocks.org/TheMapSmith/raw/2966bfa0af4d76c2af3a/" target="_blank">View Fullscreen</a></small>
				<small>
					<em>As of 10/5/15 the map is still being developed.</em>
				</small>
			</div>
			<p>

			</p>
			<h2>Wrap-up</h2>
			<p>
				It takes a <strong>lot</strong> of work to develop a cohesive, comprehensive
				well-designed web map of the world. Based on the responses to
				<a href="https://twitter.com/samanbb" target="_blank">Saman Bemel Benrud's</a>
				question from the other day, some cartographic heavyweights like
				<a href="https://twitter.com/jonahadkins" target="_blank">Jonah Adkins</a>
				and <a href="https://twitter.com/vtcraghead" target="_blank">Bill Morris</a>
				put the number at 1-4 work weeks.
			</p>
			<img src="img/saman-tweet.jpeg" alt="" class="shadow"/>
			<p>
				Subsequent discussion in
				<a href="http://thespatialcommunity.com" target="_blank">The Spatial Community</a>
				Slack seemed to concur. Good cartography takes time!
			</p>
			<img src="img/slack-chat.png" alt="" class="shadow"/>
			<small><em>Reposted with permission.</em></small>
			<p>
				It's a farily new thing for everyday cartographers to have the tools to
				be able to easily design a global, zoomable map. This requires a new
				set of skills:
				<ul>
					<li>Designing across zoom levels</li>
					<li>Designing data you don't have complete control over</li>
					<li>Designing across cultures</li>
					<li>Designing for both <em>dense</em> and <em>sparse</em> areas</li>
				</ul>
			</p>
			<p>
				I started this post intending to write a comprehensive guide to
				designing an awesome map with the new <span id="mapbox">Mapbox Studio</span>,
				but now I'm really concerned that I've only given you sufficient
				instruction for drawing some circles, and I'm leaving it up to you to
				figure out how to draw the rest of the f$#%ing owl.
			</p>
			<div class="centered">
				<img src="img/owl.jpg" alt="" class="shadow"/>
			</div>
			<p>
				Maybe someday I'll record a screencast or make a video about designing
				a global basemap. Would you watch something like that?
			</p>
			<p>
				If you found this useful at all, I'd really appreicate hearing from you.
			</p>
			<p>
				You can reach me at stephen@mapsmith.net
			</p>
			<p>
				I'm on Twitter @TheMapSmith
			</p>


<h4>For more reading</h4>
<p>
	<a href="https://www.mapbox.com/blog/tags/mapbox-studio/" target="_blank">
	Check out the <span id="mapbox">Mapbox</span> blog.
	</a>
</p>

</body>
